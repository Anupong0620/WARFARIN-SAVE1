<!DOCTYPE html>
<html lang="th">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Warfarin Save</title>
Â  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet"/>

Â  <style>
Â  Â  :root{
Â  Â  Â  --bg:#f4f7f6; --card:#ffffff; --text:#1f2937; --muted:#6b7280;
Â  Â  Â  --primary:#0056b3; --success:#28a745; --danger:#dc3545; --border:#e5e7eb;
Â  Â  Â  --shadow:0 8px 22px rgba(0,0,0,0.08); --radius:14px;
Â  Â  }

Â  Â  *{box-sizing:border-box}
Â  Â  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:'Sarabun',system-ui,Segoe UI,Roboto,Arial,"Noto Sans Thai",sans-serif}

Â  Â  /* à¹„à¸”à¹‰à¹€à¸à¸´à¹ˆà¸¡ gap: 12px; à¹€à¸‚à¹‰à¸²à¹„à¸›à¹ƒà¸™ style à¸‚à¸­à¸‡ .topbar */
Â  Â  .topbar{position:sticky;top:0;z-index:50;background:linear-gradient(180deg,#f4f7f6 90%,rgba(244,247,246,0));padding:16px 12px 8px;display:flex;justify-content:center; **gap: 12px;**}
Â  Â  .link-btn{display:inline-flex;align-items:center;gap:10px;background:var(--success);color:#fff;font-weight:700;padding:10px 18px;border-radius:10px;text-decoration:none;box-shadow:0 6px 14px rgba(40,167,69,.25);transition:transform .06s ease,filter .2s ease}
Â  Â  .link-btn:hover{filter:brightness(.95)} .link-btn:active{transform:translateY(1px)}

Â  Â  .wrap{max-width:860px;margin:0 auto;padding:0 14px 28px}
Â  Â  .container{width:100%;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:26px;margin-top:6px}

Â  Â  h1{color:var(--primary);text-align:center;font-size:clamp(22px,2.6vw,32px);margin:8px 0 18px;display:flex;align-items:center;justify-content:center;gap:10px}

Â  Â  fieldset{border:1px solid var(--border);border-radius:10px;padding:16px;margin:18px 0}
Â  Â  legend{font-weight:700;color:#374151;padding:0 8px}
Â  Â  label{display:block;margin-bottom:8px;font-weight:600;color:#374151}
Â  Â  .help{color:var(--muted);font-size:.95rem}

Â  Â  input[type="date"],input[type="number"],input[type="text"],select,textarea{
Â  Â  Â  width:100%;padding:11px 12px;border:1px solid #d1d5db;border-radius:10px;font-size:1rem;outline:none;transition:box-shadow .15s,border-color .15s;background:#fff}
Â  Â  textarea{resize:vertical}
Â  Â  input:focus,select:focus,textarea:focus{border-color:#93c5fd;box-shadow:0 0 0 3px rgba(59,130,246,.15)}

Â  Â  .date-row{display:grid;grid-template-columns:1fr;gap:14px}
Â  Â  @media (min-width:680px){.date-row{grid-template-columns:1fr 1fr}}

Â  Â  .radio-group{display:flex;flex-wrap:wrap;gap:14px}
Â  Â  .radio-group label{display:inline-flex;align-items:center;gap:8px;font-weight:500;margin:0}

Â  Â  .inline-controls{display:flex;flex-wrap:wrap;gap:22px;align-items:end}
Â  Â  .inline-controls .control-item{display:flex;align-items:center;gap:8px}
Â  Â  .inline-controls input[type="number"]{width:90px}

Â  Â  /* --- dose line: à¹„à¸¡à¹ˆà¸‹à¹‰à¸­à¸™à¸šà¸£à¸£à¸—à¸±à¸”à¸šà¸™à¸ˆà¸­à¸à¸§à¹‰à¸²à¸‡ --- */
Â  Â  .dose-line{display:flex;align-items:center;gap:10px;flex-wrap:nowrap}
Â  Â  .dose-line span{white-space:nowrap}
Â  Â  .dose-line input[type="number"]{width:90px;flex:0 0 90px}
Â  Â  .dose-line select{flex:0 0 auto;width:auto;max-width:100%;min-width:210px}
Â  Â  @media (max-width:640px){
Â  Â  Â  .dose-line{flex-wrap:wrap}
Â  Â  Â  .dose-line select{min-width:180px}
Â  Â  }

Â  Â  #incorrect-details{display:none}
Â  Â  #recommendation{margin-top:10px;padding:14px;background:#e9f7ef;border-left:6px solid var(--success);border-radius:10px;min-height:50px;color:#065f46;font-weight:600}

Â  Â  /* à¸à¸²à¸£à¹Œà¸”à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ: à¸›à¸£à¸±à¸šà¹€à¸›à¹‡à¸™ auto-fit 3 à¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œà¹„à¸”à¹‰ */
Â  Â  .dose-results{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px}
Â  Â  .result-card{padding:12px 14px;border:1px dashed var(--border);border-radius:10px;background:#fafafa}
Â  Â  .result-card strong{color:var(--primary);font-size:1.1rem}
Â  Â  #doseChangePercent.increase{color:#15803d}
Â  Â  #doseChangePercent.decrease{color:#b91c1c}

Â  Â  .button-group{display:grid;grid-template-columns:1fr 1fr;gap:12px}
Â  Â  .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:none;cursor:pointer;padding:12px;border-radius:10px;font-weight:700;font-size:1.05rem;color:#fff;transition:filter .15s,transform .06s}
Â  Â  .btn:active{transform:translateY(1px)}
Â  Â  #getResultButton{background:#007bff} #getResultButton:hover{filter:brightness(.95)}
Â  Â  #resetButton{background:var(--danger)} #resetButton:hover{filter:brightness(.95)}

Â  Â  #summarySection{display:none;margin-top:16px}
Â  Â  #summaryHeader{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
Â  Â  #copyButton{padding:8px 14px;font-size:.95rem;background:#6c757d;color:#fff;border:none;border-radius:10px;cursor:pointer}
Â  Â  #copyButton:hover{filter:brightness(.95)}

Â  Â  /* --- à¹à¸¢à¸à¸šà¸£à¸£à¸—à¸±à¸”à¹€à¸‰à¸à¸²à¸°à¸šà¸£à¸´à¹€à¸§à¸“à¹‚à¸”à¸ª à¸à¸±à¸šà¸à¸²à¸£à¹Œà¸”à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ --- */
Â  Â  /* à¹€à¸à¸´à¹ˆà¸¡à¸Šà¹ˆà¸­à¸‡à¸§à¹ˆà¸²à¸‡à¹€à¸‰à¸à¸²à¸° .dose-line à¸•à¸±à¸§à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢à¸à¹ˆà¸­à¸™à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ */
Â  Â  fieldset .dose-line:last-of-type {
Â  Â  margin-bottom: 14px;Â  Â  Â /* à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸à¹ˆà¸­à¸™à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¹Œà¸”à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œ */
}

/* à¹€à¸œà¸·à¹ˆà¸­à¸šà¸²à¸‡à¸˜à¸µà¸¡ margin-collapse à¹ƒà¸«à¹‰à¸¢à¸à¸à¸²à¸£à¹Œà¸”à¸¥à¸‡à¸­à¸µà¸à¸™à¸´à¸” */
.dose-line + .dose-results {
Â  margin-top: 6px;
}

Â  </style>
</head>
<body>
Â  Â  <div class="topbar">
Â  Â  <a class="link-btn" href="http://thaiacc.org/warfarin/program2/#/" target="_blank" rel="noopener">
Â  Â  Â  ğŸŒ à¹€à¸›à¸´à¸”à¹‚à¸›à¸£à¹à¸à¸£à¸¡ Warfarin Online
Â  Â  </a>
Â  Â  **<a class="link-btn" href="https://docs.google.com/spreadsheets/d/1w2LuZayi2xE8KM0hTh_JSSr3uY89G4EXE6P_oTHaBu0/edit?usp=sharing" target="_blank" rel="noopener" style="background:var(--primary);">
Â  Â  Â  ğŸ“Š à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸‚à¸™à¸²à¸” Warfarin
Â  Â  </a>**
Â  </div>

Â  <div class="wrap">
Â  Â  <div class="container">
Â  Â  Â  <h1>Warfarin Save ğŸ“</h1>

Â  Â  Â  <form id="warfarinForm" onsubmit="return false;">
Â  Â  Â  Â  Â  Â  Â  Â  <fieldset>
Â  Â  Â  Â  Â  <legend>à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢</legend>
Â  Â  Â  Â  Â  <div class="date-row">
Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  <label for="visitDate">à¸§à¸±à¸™à¸—à¸µà¹ˆà¸¡à¸²à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥:</label>
Â  Â  Â  Â  Â  Â  Â  <input type="date" id="visitDate" name="visitDate" />
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  <label for="nextAppointment">à¸§à¸±à¸™à¸—à¸µà¹ˆà¸™à¸±à¸”à¸„à¸£à¸±à¹‰à¸‡à¸•à¹ˆà¸­à¹„à¸›:</label>
Â  Â  Â  Â  Â  Â  Â  <input type="date" id="nextAppointment" name="nextAppointment" />
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </fieldset>

Â  Â  Â  Â  Â  Â  Â  Â  <fieldset>
Â  Â  Â  Â  Â  <legend>à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ INR à¹à¸¥à¸°à¸à¸²à¸£à¸à¸´à¸™à¸¢à¸²</legend>

Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>à¸à¸²à¸£à¸à¸´à¸™à¸¢à¸²à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢:</label>
Â  Â  Â  Â  Â  Â  <div class="radio-group">
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="medicationAdherence" value="à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡" checked>à¸à¸´à¸™à¸¢à¸²à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="medicationAdherence" value="à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡">à¸à¸´à¸™à¸¢à¸²à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡</label>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="incorrect-details" class="form-group">
Â  Â  Â  Â  Â  Â  Â  <label for="incorrectReason">à¸£à¸°à¸šà¸¸à¸ªà¸²à¹€à¸«à¸•à¸¸:</label>
Â  Â  Â  Â  Â  Â  Â  <textarea id="incorrectReason" rows="2" placeholder="à¹€à¸Šà¹ˆà¸™ à¸¥à¸·à¸¡à¸à¸´à¸™ 2 à¸§à¸±à¸™ / à¸›à¸£à¸±à¸šà¸¢à¸²à¹€à¸­à¸‡ à¸¯à¸¥à¸¯"></textarea>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>INR à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢:</label>
Â  Â  Â  Â  Â  Â  <div class="radio-group">
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="targetINR" value="2-3" checked>2â€“3</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="targetINR" value="2.5-3.5">2.5â€“3.5</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="targetINR" value="other">à¸­à¸·à¹ˆà¸™à¹†:
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="otherINR" style="width:110px" disabled placeholder="à¹€à¸Šà¹ˆà¸™ 2.0â€“2.5">
Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label for="previousDose">à¸‚à¸™à¸²à¸”à¸¢à¸²à¹€à¸”à¸´à¸¡à¸—à¸µà¹ˆà¹„à¸”à¹‰à¸£à¸±à¸š (mg/wk):</label>
Â  Â  Â  Â  Â  Â  <input type="number" id="previousDose" step="0.1" placeholder="à¸à¸£à¸­à¸à¸‚à¸™à¸²à¸”à¸¢à¸²à¹€à¸”à¸´à¸¡à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ" />
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label for="currentINR">INR à¸§à¸±à¸™à¸™à¸µà¹‰:</label>
Â  Â  Â  Â  Â  Â  <input type="number" id="currentINR" step="0.1" placeholder="à¸à¸£à¸­à¸à¸„à¹ˆà¸² INR à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¹€à¸¥à¸‚" />
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </fieldset>

Â  Â  Â  Â  Â  Â  Â  Â  <fieldset>
Â  Â  Â  Â  Â  <legend>à¸„à¸³à¹à¸™à¸°à¸™à¸³à¸•à¸²à¸¡à¸œà¸¥ INR</legend>
Â  Â  Â  Â  Â  <div id="recommendation"><p>à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ INR à¸§à¸±à¸™à¸™à¸µà¹‰à¹€à¸à¸·à¹ˆà¸­à¸”à¸¹à¸„à¸³à¹à¸™à¸°à¸™à¸³</p></div>
Â  Â  Â  Â  Â  <p class="help">âš ï¸ à¸à¸²à¸£à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢à¸„à¸§à¸£à¸­à¸¢à¸¹à¹ˆà¸ à¸²à¸¢à¹ƒà¸•à¹‰à¸”à¸¸à¸¥à¸¢à¸à¸´à¸™à¸´à¸ˆà¸‚à¸­à¸‡à¹à¸à¸—à¸¢à¹Œ/à¹€à¸ à¸ªà¸±à¸Šà¸à¸£à¸•à¸²à¸¡à¸šà¸£à¸´à¸šà¸—à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢</p>
Â  Â  Â  Â  </fieldset>

Â  Â  Â  Â  Â  Â  Â  Â  <fieldset>
Â  Â  Â  Â  Â  <legend>à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡</legend>
Â  Â  Â  Â  Â  <div class="inline-controls">
Â  Â  Â  Â  Â  Â  <div class="control-item">
Â  Â  Â  Â  Â  Â  Â  <label><input type="checkbox" id="stopMedCheckbox">à¸«à¸¢à¸¸à¸”à¸¢à¸²</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" id="stopMedDays" placeholder="à¸§à¸±à¸™" disabled>
Â  Â  Â  Â  Â  Â  Â  <span class="help">à¸§à¸±à¸™</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="control-item">
Â  Â  Â  Â  Â  Â  Â  <label><input type="checkbox" id="vitKCheckbox">à¹ƒà¸«à¹‰ Vitamin K</label>
Â  Â  Â  Â  Â  Â  Â  <input type="number" id="vitKMg" step="0.1" placeholder="mg" disabled>
Â  Â  Â  Â  Â  Â  Â  <span class="help">mg</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </fieldset>

Â  Â  Â  Â  Â  Â  Â  Â  <fieldset>
Â  Â  Â  Â  Â  <legend>à¸‚à¸™à¸²à¸”à¸¢à¸²à¹à¸™à¸°à¸™à¸³</legend>

Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>à¸‚à¸™à¸²à¸”à¸¢à¸² (Strength):</label>
Â  Â  Â  Â  Â  Â  <div class="radio-group">
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="tabletStrength" value="2">2 mg</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="tabletStrength" value="3" checked>3 mg</label>
Â  Â  Â  Â  Â  Â  Â  <label><input type="radio" name="tabletStrength" value="5">5 mg</label>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group dose-line">
Â  Â  Â  Â  Â  Â  <span>à¸à¸´à¸™à¸„à¸£à¸±à¹‰à¸‡à¸¥à¸°</span>
Â  Â  Â  Â  Â  Â  <input type="number" id="dose1_qty" value="1" step="0.5">
Â  Â  Â  Â  Â  Â  <span>à¹€à¸¡à¹‡à¸” à¸à¹ˆà¸­à¸™à¸™à¸­à¸™</span>
Â  Â  Â  Â  Â  Â  <select id="dose1_days">
Â  Â  Â  Â  Â  Â  Â  <option value="7">à¸—à¸¸à¸à¸§à¸±à¸™</option>
Â  Â  Â  Â  Â  Â  Â  <option value="3" selected>à¸ˆà¸±à¸™à¸—à¸£à¹Œ à¸à¸¸à¸˜ à¸¨à¸¸à¸à¸£à¹Œ</option>
Â  Â  Â  Â  Â  Â  Â  <option value="5">à¸ˆà¸±à¸™à¸—à¸£à¹Œ à¸–à¸¶à¸‡ à¸¨à¸¸à¸à¸£à¹Œ</option>
Â  Â  Â  Â  Â  Â  Â  <option value="6">à¸ˆà¸±à¸™à¸—à¸£à¹Œ à¸–à¸¶à¸‡ à¹€à¸ªà¸²à¸£à¹Œ</option>
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="form-group dose-line">
Â  Â  Â  Â  Â  Â  <span>à¸à¸´à¸™à¸„à¸£à¸±à¹‰à¸‡à¸¥à¸°</span>
Â  Â  Â  Â  Â  Â  <input type="number" id="dose2_qty" value="0.5" step="0.5">
Â  Â  Â  Â  Â  Â  <span>à¹€à¸¡à¹‡à¸” à¸à¹ˆà¸­à¸™à¸™à¸­à¸™</span>
Â  Â  Â  Â  Â  Â  <select id="dose2_days">
Â  Â  Â  Â  Â  Â  Â  <option value="0">- (à¹„à¸¡à¹ˆà¹à¸ªà¸”à¸‡à¸œà¸¥)</option>
Â  Â  Â  Â  Â  Â  Â  <option value="rest" selected>à¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸«à¸¥à¸·à¸­</option>
Â  Â  Â  Â  Â  Â  Â  <option value="2">à¹€à¸ªà¸²à¸£à¹Œ - à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ</option>
Â  Â  Â  Â  Â  Â  Â  <option value="1">à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ</option>
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  <div class="dose-results">
Â  Â  Â  Â  Â  Â  <div class="result-card">
Â  Â  Â  Â  Â  Â  Â  <div><strong>à¸‚à¸™à¸²à¸”à¸¢à¸²à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ</strong></div>
Â  Â  Â  Â  Â  Â  Â  <div id="totalDoseResult">0 mg/wk</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="result-card">
Â  Â  Â  Â  Â  Â  Â  <div><strong>à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸”à¸¢à¸²à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ</strong></div>
Â  Â  Â  Â  Â  Â  Â  <div id="weeklyTabletsResult">- à¹€à¸¡à¹‡à¸”/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="result-card">
Â  Â  Â  Â  Â  Â  Â  <div><strong>à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¸‚à¸™à¸²à¸”à¸¢à¸²</strong></div>
Â  Â  Â  Â  Â  Â  Â  <div id="doseChangePercent">- %</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </fieldset>

Â  Â  Â  Â  Â  Â  Â  Â  <fieldset>
Â  Â  Â  Â  Â  <legend>à¸¢à¸²à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”</legend>
Â  Â  Â  Â  Â  <div class="result-card" style="margin-bottom:10px">
Â  Â  Â  Â  Â  Â  <div><strong>à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸ˆà¸™à¸–à¸¶à¸‡à¸™à¸±à¸”à¸–à¸±à¸”à¹„à¸›</strong></div>
Â  Â  Â  Â  Â  Â  <div id="appointmentDuration">à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆà¸™à¸±à¸”</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="result-card">
Â  Â  Â  Â  Â  Â  <div><strong>à¸ˆà¸³à¸™à¸§à¸™à¸¢à¸²à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¸ˆà¸™à¸–à¸¶à¸‡à¸™à¸±à¸”à¸–à¸±à¸”à¹„à¸›</strong></div>
Â  Â  Â  Â  Â  Â  <div id="totalTabletsNeeded">- à¹€à¸¡à¹‡à¸”</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </fieldset>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="button-group">
Â  Â  Â  Â  Â  <button type="button" class="btn" id="getResultButton">à¹à¸ªà¸”à¸‡à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¸ªà¸£à¸¸à¸›</button>
Â  Â  Â  Â  Â  <button type="button" class="btn" id="resetButton">à¸£à¸µà¹€à¸‹à¹‡à¸•à¸‚à¹‰à¸­à¸¡à¸¹à¸¥</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div id="summarySection">
Â  Â  Â  Â  Â  <div id="summaryHeader">
Â  Â  Â  Â  Â  Â  <label for="summaryOutput">à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸£à¸¸à¸›:</label>
Â  Â  Â  Â  Â  Â  <button type="button" id="copyButton">à¸„à¸±à¸”à¸¥à¸­à¸</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <textarea id="summaryOutput" rows="14" readonly></textarea>
Â  Â  Â  Â  </div>
Â  Â  Â  </form>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  // ---------- à¹€à¸à¹‡à¸š Elements ----------
Â  Â  const warfarinForm = document.getElementById('warfarinForm');
Â  Â  const visitDateInput = document.getElementById('visitDate');
Â  Â  const nextAppointmentInput = document.getElementById('nextAppointment');
Â  Â  const medicationRadios = document.querySelectorAll('input[name="medicationAdherence"]');
Â  Â  const incorrectDetailsDiv = document.getElementById('incorrect-details');
Â  Â  const incorrectReasonTextarea = document.getElementById('incorrectReason');

Â  Â  const currentINRInput = document.getElementById('currentINR');
Â  Â  const targetINRRadios = document.querySelectorAll('input[name="targetINR"]');
Â  Â  const recommendationDiv = document.getElementById('recommendation');
Â  Â  const otherINRRadio = document.querySelector('input[value="other"]');
Â  Â  const otherINRInput = document.getElementById('otherINR');

Â  Â  const previousDoseInput = document.getElementById('previousDose');

Â  Â  const stopMedCheckbox = document.getElementById('stopMedCheckbox');
Â  Â  const stopMedDays = document.getElementById('stopMedDays');
Â  Â  const vitKCheckbox = document.getElementById('vitKCheckbox');
Â  Â  const vitKMg = document.getElementById('vitKMg');

Â  Â  const strengthRadios = document.querySelectorAll('input[name="tabletStrength"]');
Â  Â  const dose1QtyInput = document.getElementById('dose1_qty');
Â  Â  const dose1DaysSelect = document.getElementById('dose1_days');
Â  Â  const dose2QtyInput = document.getElementById('dose2_qty');
Â  Â  const dose2DaysSelect = document.getElementById('dose2_days');

Â  Â  const totalDoseResultDiv = document.getElementById('totalDoseResult');
Â  Â  const weeklyTabletsResultDiv = document.getElementById('weeklyTabletsResult');
Â  Â  const doseChangePercentDiv = document.getElementById('doseChangePercent');
Â  Â  const appointmentDurationDiv = document.getElementById('appointmentDuration');
Â  Â  const totalTabletsNeededDiv = document.getElementById('totalTabletsNeeded');

Â  Â  const getResultButton = document.getElementById('getResultButton');
Â  Â  const resetButton = document.getElementById('resetButton');
Â  Â  const summarySection = document.getElementById('summarySection');
Â  Â  const summaryOutput = document.getElementById('summaryOutput');
Â  Â  const copyButton = document.getElementById('copyButton');

Â  Â  // ---------- Helper ----------
Â  Â  function formatNumber(num){ return (num % 1 === 0) ? String(num) : num.toFixed(1); }

Â  Â  // ---------- à¸„à¸³à¹à¸™à¸°à¸™à¸³à¸•à¸²à¸¡ INR ----------
Â  Â  function updateRecommendation(){
Â  Â  Â  const inrValue = parseFloat(currentINRInput.value);
Â  Â  Â  const targetRange = document.querySelector('input[name="targetINR"]:checked').value;
Â  Â  Â  let text = 'à¸à¸£à¸¸à¸“à¸²à¸à¸£à¸­à¸ INR à¸§à¸±à¸™à¸™à¸µà¹‰à¹ƒà¸«à¹‰à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡';

Â  Â  Â  if (isNaN(inrValue)){ recommendationDiv.innerHTML = `<p>${text}</p>`; return; }

Â  Â  Â  if (targetRange === '2-3'){
Â  Â  Â  Â  if (inrValue < 1.5) text = '<strong>INR &lt; 1.5:</strong> à¹€à¸à¸´à¹ˆà¸¡à¸‚à¸™à¸²à¸”à¸¢à¸² warfarin à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ 10â€“20%';
Â  Â  Â  Â  else if (inrValue <= 1.9) text = '<strong>INR 1.5â€“1.9:</strong> à¹€à¸à¸´à¹ˆà¸¡à¸‚à¸™à¸²à¸”à¸¢à¸² 5â€“10%';
Â  Â  Â  Â  else if (inrValue <= 3) text = '<strong>INR 2â€“3:</strong> à¹„à¸¡à¹ˆà¸›à¸£à¸±à¸šà¸‚à¸™à¸²à¸”à¸¢à¸²';
Â  Â  Â  Â  else if (inrValue <= 3.9) text = '<strong>INR 3.1â€“3.9:</strong> à¸¥à¸”à¸‚à¸™à¸²à¸”à¸¢à¸² 5â€“10%';
Â  Â  Â  Â  else if (inrValue <= 4.9) text = '<strong>INR 4.0â€“4.9:</strong> à¸«à¸¢à¸¸à¸” 1 à¸§à¸±à¸™ à¹à¸¥à¸°à¸¥à¸” 10%';
Â  Â  Â  Â  else if (inrValue <= 8.9) text = '<strong>INR 5â€“8.9:</strong> à¸«à¸¢à¸¸à¸” 1â€“2 à¸§à¸±à¸™, à¸¥à¸” 20% à¹à¸¥à¸°à¹ƒà¸«à¹‰ Vitamin K 1â€“2.5 mg';
Â  Â  Â  Â  else text = '<strong>INR &gt; 8.9:</strong> à¸«à¸¢à¸¸à¸”à¸¢à¸², à¸¥à¸” 20% à¹à¸¥à¸°à¹ƒà¸«à¹‰ Vitamin K 5â€“10 mg';
Â  Â  Â  } else if (targetRange === '2.5-3.5'){
Â  Â  Â  Â  if (inrValue < 2) text = '<strong>INR &lt; 2:</strong> à¹€à¸à¸´à¹ˆà¸¡à¸‚à¸™à¸²à¸”à¸¢à¸² 10â€“20%';
Â  Â  Â  Â  else if (inrValue <= 2.4) text = '<strong>INR 2â€“2.4:</strong> à¹€à¸à¸´à¹ˆà¸¡ 5â€“10%';
Â  Â  Â  Â  else if (inrValue <= 3.5) text = '<strong>INR 2.5â€“3.5:</strong> à¹„à¸¡à¹ˆà¸›à¸£à¸±à¸šà¸‚à¸™à¸²à¸”à¸¢à¸²';
Â  Â  Â  Â  else if (inrValue <= 4.4) text = '<strong>INR 3.6â€“4.4:</strong> à¸¥à¸” 5â€“10%';
Â  Â  Â  Â  else if (inrValue <= 6) text = '<strong>INR 4.5â€“6:</strong> à¸«à¸¢à¸¸à¸” 1 à¸§à¸±à¸™ à¹à¸¥à¸°à¸¥à¸” 10%';
Â  Â  Â  Â  else if (inrValue <= 9.4) text = '<strong>INR 6.1â€“9.4:</strong> à¸«à¸¢à¸¸à¸” 1â€“2 à¸§à¸±à¸™, à¸¥à¸” 20% à¹à¸¥à¸°à¹ƒà¸«à¹‰ Vitamin K 1â€“2.5 mg';
Â  Â  Â  Â  else text = '<strong>INR &gt; 9.4:</strong> à¸«à¸¢à¸¸à¸”à¸¢à¸², à¸¥à¸” 20% à¹à¸¥à¸°à¹ƒà¸«à¹‰ Vitamin K 5â€“10 mg';
Â  Â  Â  } else {
Â  Â  Â  Â  text = 'à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸„à¸³à¹à¸™à¸°à¸™à¸³à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸ªà¸³à¸«à¸£à¸±à¸šà¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸™à¸µà¹‰';
Â  Â  Â  }
Â  Â  Â  recommendationDiv.innerHTML = `<p>${text}</p>`;
Â  Â  }

Â  Â  // ---------- à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¹‚à¸”à¸ª ----------
Â  Â  function getWeeklyTablets(){
Â  Â  Â  const q1 = parseFloat(dose1QtyInput.value) || 0;
Â  Â  Â  const d1 = parseInt(dose1DaysSelect.value,10) || 0; // à¸ˆà¸³à¸™à¸§à¸™à¸§à¸±à¸™à¸‚à¸­à¸‡à¹‚à¸”à¸ªà¸—à¸µà¹ˆ 1

Â  Â  Â  const q2 = parseFloat(dose2QtyInput.value) || 0;
Â  Â  Â  let d2; // à¸ˆà¸³à¸™à¸§à¸™à¸§à¸±à¸™à¸‚à¸­à¸‡à¹‚à¸”à¸ªà¸—à¸µà¹ˆ 2

Â  Â  Â  const dose2Val = dose2DaysSelect.value;
Â  Â  Â  if (dose2Val === 'rest'){
Â  Â  Â  Â  d2 = Math.max(0, 7 - d1);Â  Â  Â  Â  // à¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸«à¸¥à¸·à¸­ = 7 - à¸§à¸±à¸™à¸‚à¸­à¸‡à¹‚à¸”à¸ªà¹à¸£à¸
Â  Â  Â  } else {
Â  Â  Â  Â  d2 = parseInt(dose2Val,10) || 0; // à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¸£à¸°à¸šà¸¸à¸§à¸±à¸™à¹„à¸§à¹‰à¸Šà¸±à¸”à¹€à¸ˆà¸™ (à¹€à¸Šà¹ˆà¸™ 2 à¸§à¸±à¸™, 1 à¸§à¸±à¸™)
Â  Â  Â  }

Â  Â  Â  return (q1 * d1) + (q2 * d2);
Â  Â  }

Â  Â  function getWeeklyMg(){
Â  Â  Â  const strength = parseFloat(document.querySelector('input[name="tabletStrength"]:checked').value) || 0;
Â  Â  Â  return strength * getWeeklyTablets();
Â  Â  }

Â  Â  function calculateDoseChange(){
Â  Â  Â  const prev = parseFloat(previousDoseInput.value);
Â  Â  Â  const now = getWeeklyMg();
Â  Â  Â  doseChangePercentDiv.classList.remove('increase','decrease');

Â  Â  Â  if (isNaN(prev) || prev <= 0){ doseChangePercentDiv.textContent='- %'; return; }

Â  Â  Â  const pct = ((now - prev) / prev) * 100;
Â  Â  Â  if (pct > 0){ doseChangePercentDiv.textContent = `à¹€à¸à¸´à¹ˆà¸¡à¸‚à¸¶à¹‰à¸™ ${pct.toFixed(2)} %`; doseChangePercentDiv.classList.add('increase'); }
Â  Â  Â  else if (pct < 0){ doseChangePercentDiv.textContent = `à¸¥à¸”à¸¥à¸‡ ${Math.abs(pct).toFixed(2)} %`; doseChangePercentDiv.classList.add('decrease'); }
Â  Â  Â  else { doseChangePercentDiv.textContent='à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡ 0.00 %'; }
Â  Â  }

Â  Â  function updateAllDoseCalculations(){
Â  Â  Â  const weeklyTabs = getWeeklyTablets();
Â  Â  Â  weeklyTabletsResultDiv.textContent = `${formatNumber(weeklyTabs)} à¹€à¸¡à¹‡à¸”/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ`;

Â  Â  Â  const weeklyMg = getWeeklyMg();
Â  Â  Â  totalDoseResultDiv.textContent = `${formatNumber(weeklyMg)} mg/wk`;

Â  Â  Â  calculateDoseChange();
Â  Â  Â  calculateTotalTabletsNeeded();
Â  Â  }

Â  Â  // ---------- à¸„à¸³à¸™à¸§à¸“à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸”à¸ˆà¸™à¸–à¸¶à¸‡à¸™à¸±à¸”à¸–à¸±à¸”à¹„à¸› ----------
Â function calculateTotalTabletsNeeded(){
Â  const visitDate = new Date(visitDateInput.value);
Â  const nextDateÂ  = new Date(nextAppointmentInput.value);

Â  if (!visitDateInput.value || !nextAppointmentInput.value || nextDate < visitDate){
Â  Â  appointmentDurationDiv.textContent = 'à¸à¸£à¸¸à¸“à¸²à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆà¹ƒà¸«à¹‰à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡';
Â  Â  totalTabletsNeededDiv.textContent = '- à¹€à¸¡à¹‡à¸”';
Â  Â  return;
Â  }

Â  // à¸£à¸§à¸¡à¸§à¸±à¸™à¹à¸šà¸šà¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸§à¸±à¸™à¹€à¸£à¸´à¹ˆà¸¡ (+1)
Â  const diffTime = nextDate.getTime() - visitDate.getTime();
Â  const diffDays = Math.round(diffTime / (1000*60*60*24)) + 1;

Â  const weeksÂ  Â  Â  Â  Â = Math.floor(diffDays / 7);
Â  const remainingDays = diffDays % 7;

Â  // à¹ƒà¸Šà¹‰à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸”à¸¢à¸²à¸•à¹ˆà¸­à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸ˆà¸²à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸”à¹‰à¸²à¸™à¸šà¸™ (à¸„à¸³à¸™à¸§à¸“à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹à¸¥à¹‰à¸§)
Â  const weeklyTablets = getWeeklyTablets();

Â  // === à¸ªà¸¹à¸•à¸£à¸—à¸µà¹ˆà¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¸à¸²à¸£ ===
Â  // à¸£à¸§à¸¡à¹€à¸›à¹‡à¸™à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸” à¹à¸¥à¸°à¸›à¸±à¸”à¹ƒà¸«à¹‰à¹€à¸›à¹‡à¸™à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸”à¹€à¸•à¹‡à¸¡
Â  // (à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹€à¸œà¸·à¹ˆà¸­à¸‚à¸²à¸”à¹€à¸ªà¸¡à¸­à¹ƒà¸«à¹‰à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Math.round -> Math.ceil)
Â  const totalTabs = Math.round((weeklyTablets * weeks) + remainingDays);

Â  appointmentDurationDiv.textContent = `${weeks} à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ ${remainingDays} à¸§à¸±à¸™`;
Â  totalTabletsNeededDiv.textContentÂ  = `${totalTabs} à¹€à¸¡à¹‡à¸”`;
}


Â  Â  // ---------- à¸ªà¸£à¸¸à¸› ----------
Â  Â  function generateSummary(){
Â  let summary = '========== à¸ªà¸£à¸¸à¸›à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Warfarin ==========\n';
Â  let adherence = document.querySelector('input[name="medicationAdherence"]:checked').value;
Â  if (adherence === 'à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡'){
Â  Â  const reason = (document.getElementById('incorrectReason').value || '').trim();
Â  Â  if (reason) adherence += ` (à¹€à¸«à¸•à¸¸à¸œà¸¥: ${reason})`;
Â  }
Â  summary += `à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢à¸à¸´à¸™à¸¢à¸² ${adherence}\n`;

Â  const targetINRValue = document.querySelector('input[name="targetINR"]:checked').value;
Â  const currentINRValue = document.getElementById('currentINR').value || '-';
Â  summary += `INR à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢ : ${targetINRValue}Â  Â INR à¸§à¸±à¸™à¸™à¸µà¹‰ : ${currentINRValue}\n`;

Â  summary += `à¸„à¸³à¹à¸™à¸°à¸™à¸³: ${document.getElementById('recommendation').textContent.trim()}\n\n`;
Â  summary += 'à¸„à¸³à¹à¸™à¸°à¸™à¸³à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸¢à¸²\n';
Â  summary += `à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡: ${document.getElementById('doseChangePercent').textContent}\n`;

Â  const strengthText = document.querySelector('input[name="tabletStrength"]:checked').value + ' mg';
Â  summary += `Warfarin ${strengthText}\n`;

Â  const dose1DaysText = document.getElementById('dose1_days')
Â  Â  .options[document.getElementById('dose1_days').selectedIndex].text;
Â  summary += `à¸à¸´à¸™ ${document.getElementById('dose1_qty').value} à¹€à¸¡à¹‡à¸” à¸à¹ˆà¸­à¸™à¸™à¸­à¸™ ${dose1DaysText}\n`;

Â  const dose2Qty = parseFloat(document.getElementById('dose2_qty').value) || 0;
Â  const dose2DaysSel = document.getElementById('dose2_days');
Â  if (dose2Qty > 0 && dose2DaysSel.value !== '0'){
Â  Â  const dose2DaysText = dose2DaysSel.options[dose2DaysSel.selectedIndex].text;
Â  Â  summary += `à¹à¸¥à¸° à¸à¸´à¸™ ${dose2Qty} à¹€à¸¡à¹‡à¸” à¸à¹ˆà¸­à¸™à¸™à¸­à¸™ ${dose2DaysText}\n`;
Â  }

Â  // === à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸¥à¸³à¸”à¸±à¸š: à¹à¸ªà¸”à¸‡ mg/wk à¸à¹ˆà¸­à¸™ à¹à¸¥à¹‰à¸§à¸„à¹ˆà¸­à¸¢à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸”/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ ===
Â  const weeklyMgÂ  Â = getWeeklyMg();
Â  const weeklyTabs = getWeeklyTablets();
Â  summary += `à¸‚à¸™à¸²à¸”à¸¢à¸² ${formatNumber(weeklyMg)} mg/wk\n`;
Â  summary += `à¸ˆà¸³à¸™à¸§à¸™à¹€à¸¡à¹‡à¸”à¸¢à¸²/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ: ${formatNumber(weeklyTabs)} à¹€à¸¡à¹‡à¸”\n`;

Â  summary += `à¸ˆà¸³à¸™à¸§à¸™à¸¢à¸²à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰: ${document.getElementById('totalTabletsNeeded').textContent}\n`;

Â  const extra = [];
Â  const stopMedCheckbox = document.getElementById('stopMedCheckbox');
Â  const stopMedDays = document.getElementById('stopMedDays');
Â  const vitKCheckbox = document.getElementById('vitKCheckbox');
Â  const vitKMg = document.getElementById('vitKMg');

Â  if (stopMedCheckbox.checked && stopMedDays.value) extra.push(`à¸«à¸¢à¸¸à¸”à¸¢à¸² ${stopMedDays.value} à¸§à¸±à¸™`);
Â  if (vitKCheckbox.checked && vitKMg.value) extra.push(`à¹ƒà¸«à¹‰ Vitamin K ${vitKMg.value} mg`);
Â  if (extra.length) summary += `${extra.join(' + ')}\n`;

Â  document.getElementById('summaryOutput').value = summary;
Â  document.getElementById('summarySection').style.display = 'block';
}

Â  Â  // ---------- à¸£à¸µà¹€à¸‹à¹‡à¸• ----------
Â  Â  function resetForm(){
Â  Â  Â  warfarinForm.reset();
Â  Â  Â  summarySection.style.display = 'none';
Â  Â  Â  incorrectDetailsDiv.style.display = 'none';
Â  Â  Â  const today = new Date().toISOString().split('T')[0];
Â  Â  Â  visitDateInput.value = today;
Â  Â  Â  updateRecommendation();
Â  Â  Â  updateAllDoseCalculations();
Â  Â  Â  otherINRInput.disabled = true;
Â  Â  Â  stopMedDays.disabled = true;
Â  Â  Â  vitKMg.disabled = true;
Â  Â  Â  window.scrollTo(0,0);
Â  Â  }

Â  Â  // ---------- Events ----------
Â  Â  stopMedCheckbox.addEventListener('change', () => { stopMedDays.disabled = !stopMedCheckbox.checked; if(!stopMedCheckbox.checked) stopMedDays.value=''; });
Â  Â  vitKCheckbox.addEventListener('change', () => { vitKMg.disabled = !vitKCheckbox.checked; if(!vitKCheckbox.checked) vitKMg.value=''; });
Â  Â  copyButton.addEventListener('click', () => {
Â  Â  Â  summaryOutput.select();
Â  Â  Â  navigator.clipboard.writeText(summaryOutput.value).then(()=>{ copyButton.textContent='à¸„à¸±à¸”à¸¥à¸­à¸à¹à¸¥à¹‰à¸§!'; setTimeout(()=>copyButton.textContent='à¸„à¸±à¸”à¸¥à¸­à¸',1500); }).catch(()=>{ alert('à¸„à¸±à¸”à¸¥à¸­à¸à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ'); });
Â  Â  });

Â  Â  currentINRInput.addEventListener('input', updateRecommendation);
Â  Â  targetINRRadios.forEach(r => r.addEventListener('change', () => {
Â  Â  Â  const useOther = otherINRRadio.checked;
Â  Â  Â  otherINRInput.disabled = !useOther;
Â  Â  Â  if (!useOther) otherINRInput.value='';
Â  Â  Â  updateRecommendation();
Â  Â  }));
Â  Â  medicationRadios.forEach(r => r.addEventListener('change', (e)=>{ incorrectDetailsDiv.style.display = (e.target.value === 'à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡') ? 'block' : 'none'; }));
Â  Â  previousDoseInput.addEventListener('input', calculateDoseChange);

Â  Â  // à¹‚à¸”à¸ª/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ
Â  Â  const doseInputs = [dose1QtyInput, dose1DaysSelect, dose2QtyInput, dose2DaysSelect];
Â  Â  strengthRadios.forEach(r => r.addEventListener('change', updateAllDoseCalculations));
Â  Â  doseInputs.forEach(el => { const ev = (el.tagName === 'SELECT') ? 'change' : 'input'; el.addEventListener(ev, updateAllDoseCalculations); });

Â  Â  visitDateInput.addEventListener('change', calculateTotalTabletsNeeded);
Â  Â  nextAppointmentInput.addEventListener('change', calculateTotalTabletsNeeded);

Â  Â  getResultButton.addEventListener('click', generateSummary);
Â  Â  resetButton.addEventListener('click', resetForm);

Â  Â  // à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™
Â  Â  document.addEventListener('DOMContentLoaded', ()=>{
Â  Â  Â  const today = new Date().toISOString().split('T')[0];
Â  Â  Â  visitDateInput.value = today;
Â  Â  Â  updateRecommendation();
Â  Â  Â  updateAllDoseCalculations();
Â  Â  });
Â  </script>
</body>
</html>
